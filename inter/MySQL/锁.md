## 分类

### 按粒度分

- 表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。
- 页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般
- 行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。

## 乐观锁和悲观锁

悲观锁具有强烈的独占性和排他性，在数据处理的时候，将数据处于锁定状态，在事务的提交之前（提交之后释放事务过程中的锁），外界无法修改这些数据，依赖于数据库提供的锁机制

乐观锁机制则是采取了更加宽松的加锁机制，避免了加锁开销，

悲观锁保证了操作的最大独占性，但是随之而来的是数据库性能的大量开销，尤其是长事务。乐观锁是基于数据版本记录机制实现，在数据库表中增加一个version字段，更新时，读取版本号，然后提交时版本号+1，但是提交的数据版本号须大于数据库表当前数据库表版本号，予以更新，否则认为是过期数据

在实现上，可以通过设置版本号字段实现乐观锁，可以在支持事务的存储引擎上通过`select...for update`实现悲观锁。