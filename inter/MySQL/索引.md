### 索引的种类？

从语法上有：

- 主键索引（PRIMARY KEY）：它是一种特殊的唯一索引，不允许有空值。一般是在建表的时候同时创建主键索引
- 唯一索引（UNIQUE）：唯一索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一。可以在创建表的时候指定，也可以修改表结构。
- 普通索引（INDEX）：这是最基本的索引，它没有任何限制。可以在创建表的时候指定，也可以修改表结构，

数据结构上有

- B<sup>+</sup> 树索引
- 哈希索引

#### 为什么使用B<sup>+</sup>树？

优化查询的数据结构还有哈希表、完全平衡二叉树、

- 哈希表：可以快速精确查询，但由于数据并非有序存储，不支持范围查找
- 完全平衡二叉树：支持范围查找，但由于一个结点只能存储一个元素，所以比B<sup>+</sup>树需要更多的 I/O 次数
- B树：比完全二叉平衡树要矮胖，只需少量 IO 就能读取到数据
- B<sup>+</sup>树：上层结点的数据冗余到叶子中，且叶子结点间存在指针相连，具有更高的范围查找的效率

#### B+树索引的查询类型

- 全值匹配
  和索引中的所有列进行匹配
- 范围查找

- 匹配最左前缀 
  从最左开始匹配，如果一直满足索引的顺序则可以使用到相关索引，如果在某个位置开始不满足，那么从这个位置开始就用不到索引了

### B+树索引的限制

- 如果不从最左列开始查找，则无法使用到索引

- 如果查询中有某个列的范围查询，则其右边的列都无法使用索引优化查找

#### 索引什么时候失效？

- 单列唯一索引：索引列为空
- 多列唯一索引：只要存在一个索引字段为空，则索引无效

#### 哈希索引

- 只有精确匹配索引的所有列的查询才有效

- 在 MySQL 中只有 Memory 引擎显式支持哈希索引 
  （如果多个行哈希值相同，索引会以链表的方式存放多个记录指针到同一个哈希条目中）

- 实现原理：

- 为每个行计算按照索引列计算一个哈希值，这个哈希值和指向该行的指针构成键值对储存

- 哈希值都是有序的，按顺序插入槽中

- 查找：使用索引列计算记录哈希值，拿它去槽中找对应的哈希值，就可以找到对应记录的指针了